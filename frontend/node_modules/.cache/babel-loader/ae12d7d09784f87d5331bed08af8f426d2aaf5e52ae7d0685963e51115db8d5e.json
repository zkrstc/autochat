{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport axios from 'axios';\nexport default {\n  __name: 'RequirementPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const requirements = ref([]);\n    const showModal = ref(false);\n    const editedContent = ref('');\n    const editingId = ref(null);\n    // const showModalForAdd = () => {\n    //     newRequirement.value = '';\n    //     editing.value = false;\n    //     showModal.value = true;\n    // };\n\n    const closeModal = () => {\n      showModal.value = false;\n    };\n    const saveRequirement = async () => {\n      try {\n        if (editingId.value) {\n          await axios.put(`http://127.0.0.1:5000/api/requirements/${editingId.value}`, {\n            content: editedContent.value\n          });\n        }\n        await fetchRequirements();\n        closeModal();\n      } catch (error) {\n        console.error('Error saving requirement:', error);\n      }\n    };\n    const fetchRequirements = async () => {\n      try {\n        const response = await axios.get('http://127.0.0.1:5000/api/requirements');\n        requirements.value = response.data;\n      } catch (error) {\n        console.error('Error fetching requirements:', error);\n      }\n    };\n    const editRequirement = requirement => {\n      editedContent.value = requirement.content;\n      editingId.value = requirement.id;\n      showModal.value = true;\n    };\n    onMounted(() => {\n      fetchRequirements();\n    });\n    // const deleteRequirement = async (id) => {\n    //     try {\n    //         await axios.delete(`/api/requirements/${id}`);\n    //         await fetchRequirements();\n    //     } catch (error) {\n    //         console.error('Error deleting requirement:', error);\n    //     }\n    // };\n\n    // export default {\n    //     setup() {\n    //         const requirements = ref([]);\n\n    //         onMounted(() => {\n    //             axios.get('http://127.0.0.1:5000/api/requirements')\n    //                 .then(response => {\n    //                     requirements.value = response.data;\n    //                 })\n    //                 .catch(error => {\n    //                     console.error('There was an error!', error);\n    //                 });\n    //         });\n\n    //         return {\n    //             requirements\n    //         };\n    //     }\n\n    // };\n    const showAddModal = ref(false);\n    const newRequirement = ref({\n      name: '',\n      version: '',\n      content: ''\n    });\n    const openAddModal = () => {\n      showAddModal.value = true;\n      newRequirement.value = {\n        name: '',\n        version: '',\n        content: ''\n      };\n    };\n    const saveNewRequirement = async () => {\n      try {\n        const userId = localStorage.getItem('user_id') || 1; // 用本地存储的 user_id\n        await axios.post('http://127.0.0.1:5000/api/requirements', {\n          ...newRequirement.value,\n          user_id: parseInt(userId)\n        });\n        showAddModal.value = false;\n        await fetchRequirements();\n      } catch (err) {\n        console.error('Error creating requirement:', err);\n      }\n    };\n    const __returned__ = {\n      requirements,\n      showModal,\n      editedContent,\n      editingId,\n      closeModal,\n      saveRequirement,\n      fetchRequirements,\n      editRequirement,\n      showAddModal,\n      newRequirement,\n      openAddModal,\n      saveNewRequirement,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","requirements","showModal","editedContent","editingId","closeModal","value","saveRequirement","put","content","fetchRequirements","error","console","response","get","data","editRequirement","requirement","id","showAddModal","newRequirement","name","version","openAddModal","saveNewRequirement","userId","localStorage","getItem","post","user_id","parseInt","err"],"sources":["C:/Users/ASUS/Desktop/autochat/frontend/src/views/RequirementPage.vue"],"sourcesContent":["<template>\r\n    <div class=\"p-8\">\r\n        <div class=\"bg-white rounded-lg shadow p-6 mb-6\">\r\n            <div class=\"flex justify-between items-center mb-6\">\r\n                <h2 class=\"text-lg font-medium\">需求列表</h2>\r\n\r\n              <button @click=\"openAddModal\" class=\"bg-primary text-white px-4 py-2 !rounded-button flex items-center\">\r\n  <i class=\"fas fa-plus mr-2\"></i>新建需求\r\n</button>\r\n\r\n            </div>\r\n            <div class=\"overflow-x-auto\">\r\n                <table class=\"w-full\">\r\n                    <!-- <thead>\r\n                                <tr class=\"bg-gray-50\">\r\n                                    <th class=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">需求名称</th>\r\n                                    <th class=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">优先级</th>\r\n                                    <th class=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">状态</th>\r\n                                    <th class=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">创建时间</th>\r\n                                    <th class=\"px-4 py-3 text-left text-sm font-medium text-gray-500\">操作</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr class=\"border-t\">\r\n                                    <td class=\"px-4 py-4 text-sm\">设计一个医院系统</td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-red-100 text-red-800 rounded text-sm\">高</span></td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-green-100 text-green-800 rounded text-sm\">进行中</span>\r\n                                    </td>\r\n                                    <td class=\"px-4 py-4 text-sm\">2024-01-15</td>\r\n                                    <td class=\"px-4 py-4\">\r\n                                        <button class=\"text-primary hover:text-primary-dark mr-2\"><i\r\n                                                class=\"fas fa-edit\"></i></button>\r\n                                        <button class=\"text-red-500 hover:text-red-600\"><i\r\n                                                class=\"fas fa-trash\"></i></button>\r\n                                    </td>\r\n                                </tr>\r\n                                <tr class=\"border-t\">\r\n                                    <td class=\"px-4 py-4 text-sm\">设计一个商城系统</td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-sm\">中</span>\r\n                                    </td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm\">待审核</span></td>\r\n                                    <td class=\"px-4 py-4 text-sm\">2024-01-14</td>\r\n                                    <td class=\"px-4 py-4\">\r\n                                        <button class=\"text-primary hover:text-primary-dark mr-2\"><i\r\n                                                class=\"fas fa-edit\"></i></button>\r\n                                        <button class=\"text-red-500 hover:text-red-600\"><i\r\n                                                class=\"fas fa-trash\"></i></button>\r\n                                    </td>\r\n                                </tr>\r\n                                <tr class=\"border-t\">\r\n                                    <td class=\"px-4 py-4 text-sm\">设计一个某某系统</td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-sm\">中</span>\r\n                                    </td>\r\n                                    <td class=\"px-4 py-4\"><span\r\n                                            class=\"px-2 py-1 bg-gray-100 text-gray-800 rounded text-sm\">已完成</span></td>\r\n                                    <td class=\"px-4 py-4 text-sm\">2024-01-13</td>\r\n                                    <td class=\"px-4 py-4\">\r\n                                        <button class=\"text-primary hover:text-primary-dark mr-2\"><i\r\n                                                class=\"fas fa-edit\"></i></button>\r\n                                        <button class=\"text-red-500 hover:text-red-600\"><i\r\n                                                class=\"fas fa-trash\"></i></button>\r\n                                    </td>\r\n                                </tr>\r\n                            </tbody> -->\r\n                    <thead>\r\n                        <tr>\r\n                            <th>ID</th>\r\n                            <th>User ID</th>\r\n                            <th>Name</th>\r\n                            <th>Version</th>\r\n                            <!-- <th>Content</th> -->\r\n                            <th>Created At</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr v-for=\"requirement in requirements\" :key=\"requirement.id\">\r\n                            <td>{{ requirement.id }}</td>\r\n                            <td>{{ requirement.user_id }}</td>\r\n                            <td>{{ requirement.name }}</td>\r\n                            <td>{{ requirement.version }}</td>\r\n                            <!-- <td>{{ requirement.content }}</td> -->\r\n                            <td>{{ requirement.created_at }}</td>\r\n                            <td class=\"px-4 py-4\">\r\n\r\n                                <button class=\"text-primary hover:text-primary-dark mr-2\"\r\n                                    @click=\"editRequirement(requirement)\">Edit</button>\r\n                                <button class=\"btn btn-danger btn-sm\"\r\n                                    @click=\"deleteRequirement(requirement.id)\">Delete</button>\r\n\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n\r\n            </div>\r\n\r\n          <div v-if=\"showModal\" class=\"modal\">\r\n  <div class=\"modal-content\">\r\n    <h3 class=\"text-lg font-semibold mb-4\">编辑需求内容</h3>\r\n    <textarea\r\n      v-model=\"editedContent\"\r\n      rows=\"6\"\r\n      class=\"w-full border rounded px-3 py-2 text-sm focus:outline-primary resize-none\"\r\n      placeholder=\"请输入需求内容\"\r\n    ></textarea>\r\n\r\n    <div class=\"flex justify-end space-x-3 mt-4\">\r\n      <button @click=\"closeModal\" class=\"px-4 py-2 border rounded text-sm text-gray-600\">取消</button>\r\n      <button @click=\"saveRequirement\" class=\"px-4 py-2 bg-primary text-white rounded text-sm hover:bg-blue-600\">\r\n        保存\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n        </div>\r\n\r\n        <div class=\"bg-white rounded-lg shadow p-6\">\r\n            <h2 class=\"text-lg font-medium mb-6\">需求统计</h2>\r\n            <div class=\"grid grid-cols-4 gap-6\">\r\n                <div class=\"p-4 bg-blue-50 rounded-lg\">\r\n                    <div class=\"text-blue-600 mb-2\">\r\n                        <i class=\"fas fa-clipboard-list text-xl\"></i>\r\n                    </div>\r\n                    <div class=\"text-2xl font-semibold text-gray-800\">24</div>\r\n                    <div class=\"text-sm text-gray-500\">总需求数</div>\r\n                </div>\r\n                <div class=\"p-4 bg-green-50 rounded-lg\">\r\n                    <div class=\"text-green-600 mb-2\">\r\n                        <i class=\"fas fa-check-circle text-xl\"></i>\r\n                    </div>\r\n                    <div class=\"text-2xl font-semibold text-gray-800\">18</div>\r\n                    <div class=\"text-sm text-gray-500\">已完成</div>\r\n                </div>\r\n                <div class=\"p-4 bg-yellow-50 rounded-lg\">\r\n                    <div class=\"text-yellow-600 mb-2\">\r\n                        <i class=\"fas fa-clock text-xl\"></i>\r\n                    </div>\r\n                    <div class=\"text-2xl font-semibold text-gray-800\">4</div>\r\n                    <div class=\"text-sm text-gray-500\">进行中</div>\r\n                </div>\r\n                <div class=\"p-4 bg-red-50 rounded-lg\">\r\n                    <div class=\"text-red-600 mb-2\">\r\n                        <i class=\"fas fa-exclamation-circle text-xl\"></i>\r\n                    </div>\r\n                    <div class=\"text-2xl font-semibold text-gray-800\">2</div>\r\n                    <div class=\"text-sm text-gray-500\">待处理</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<div v-if=\"showAddModal\" class=\"modal\">\r\n  <div class=\"modal-content\">\r\n    <h3 class=\"text-lg font-semibold mb-4\">新建需求</h3>\r\n\r\n    <div class=\"space-y-3\">\r\n      <input\r\n        v-model=\"newRequirement.name\"\r\n        placeholder=\"需求名称\"\r\n        class=\"w-full border rounded px-3 py-2 text-sm focus:outline-primary\"\r\n      />\r\n      <input\r\n        v-model=\"newRequirement.version\"\r\n        placeholder=\"版本号\"\r\n        class=\"w-full border rounded px-3 py-2 text-sm focus:outline-primary\"\r\n      />\r\n      <textarea\r\n        v-model=\"newRequirement.content\"\r\n        placeholder=\"请输入需求内容\"\r\n        rows=\"5\"\r\n        class=\"w-full border rounded px-3 py-2 text-sm focus:outline-primary\"\r\n      ></textarea>\r\n    </div>\r\n\r\n    <div class=\"flex justify-end space-x-3 mt-4\">\r\n      <button @click=\"showAddModal = false\" class=\"px-4 py-2 border rounded text-sm text-gray-600\">取消</button>\r\n      <button @click=\"saveNewRequirement\" class=\"px-4 py-2 bg-primary text-white rounded text-sm hover:bg-blue-600\">保存</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue';\r\nimport axios from 'axios';\r\n\r\n\r\nconst requirements = ref([]);\r\nconst showModal = ref(false)\r\nconst editedContent = ref('')\r\nconst editingId = ref(null)\r\n// const showModalForAdd = () => {\r\n//     newRequirement.value = '';\r\n//     editing.value = false;\r\n//     showModal.value = true;\r\n// };\r\n\r\n\r\nconst closeModal = () => {\r\n    showModal.value = false;\r\n};\r\n\r\nconst saveRequirement = async () => {\r\n    try {\r\n        if (editingId.value) {\r\n            await axios.put(`http://127.0.0.1:5000/api/requirements/${editingId.value}`, { content: editedContent.value });\r\n        } \r\n        await fetchRequirements();\r\n        closeModal();\r\n    } catch (error) {\r\n        console.error('Error saving requirement:', error);\r\n    }\r\n};\r\n\r\nconst fetchRequirements = async () => {\r\n    try {\r\n        const response = await axios.get('http://127.0.0.1:5000/api/requirements');\r\n        requirements.value = response.data;\r\n    } catch (error) {\r\n        console.error('Error fetching requirements:', error);\r\n    }\r\n};\r\nconst editRequirement = (requirement) => {\r\n    editedContent.value = requirement.content\r\n    editingId.value = requirement.id\r\n    showModal.value = true\r\n}\r\nonMounted(() => {\r\n    fetchRequirements();\r\n});\r\n// const deleteRequirement = async (id) => {\r\n//     try {\r\n//         await axios.delete(`/api/requirements/${id}`);\r\n//         await fetchRequirements();\r\n//     } catch (error) {\r\n//         console.error('Error deleting requirement:', error);\r\n//     }\r\n// };\r\n\r\n\r\n// export default {\r\n//     setup() {\r\n//         const requirements = ref([]);\r\n\r\n//         onMounted(() => {\r\n//             axios.get('http://127.0.0.1:5000/api/requirements')\r\n//                 .then(response => {\r\n//                     requirements.value = response.data;\r\n//                 })\r\n//                 .catch(error => {\r\n//                     console.error('There was an error!', error);\r\n//                 });\r\n//         });\r\n\r\n//         return {\r\n//             requirements\r\n//         };\r\n//     }\r\n    \r\n// };\r\nconst showAddModal = ref(false)\r\nconst newRequirement = ref({\r\n  name: '',\r\n  version: '',\r\n  content: '',\r\n})\r\n\r\nconst openAddModal = () => {\r\n  showAddModal.value = true\r\n  newRequirement.value = {\r\n    name: '',\r\n    version: '',\r\n    content: ''\r\n  }\r\n}\r\n\r\nconst saveNewRequirement = async () => {\r\n  try {\r\n    const userId = localStorage.getItem('user_id') || 1  // 用本地存储的 user_id\r\n    await axios.post('http://127.0.0.1:5000/api/requirements', {\r\n      ...newRequirement.value,\r\n      user_id: parseInt(userId)\r\n    })\r\n    showAddModal.value = false\r\n    await fetchRequirements()\r\n  } catch (err) {\r\n    console.error('Error creating requirement:', err)\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n.modal {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    background: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.modal-content {\r\n    background: white;\r\n    padding: 1em;\r\n    margin: 10% auto;\r\n    width: 600px;\r\n    border-radius: 8px;\r\n}\r\n\r\n.textarea {\r\n    width: 100%;\r\n    height: 600px;\r\n    \r\n    margin-bottom: 1em;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}